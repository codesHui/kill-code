<!DOCTYPE html>
<!--<#include "comm.ftl" /><@doctype />  -->
<html>
<head>
<meta charset="utf-8" />
<title>产品查询</title>
<!--<@cssJs /> -->
<style type="text/css">
*+html .leftbox .titlename{margin-right:-3px}/* IE7 */ 
*+html  .input_div{ /* background-color: olive; */padding: 0px;text-align: left;}/* IE7 */ 


</style>
</head>
<body>

<!--<@topFrontHead  title="产品查询"/> -->
		<form action="<@s.url'/front/product/list'/>" method="post" id="submit_product_info">
			<div class="product_condition" align="center">
				<div class="content">
					<div class="float_left leftbox" style="margin-left: 25px;">
						<div class="hangstyle margin_top_10">
							<div class="float_left titlename" >产品类别：</div>
							<div >
							    <input type="hidden" id="productType" name="productType" value="${productInfo.productType}" />
								<div id="category_all" class="float_left margin_top_15 margin_left_10 radio_normal">
								</div>
								<span  style="margin-left: 5px;" class="float_left">全部</span>
								<div id="category_pre"  class="float_left margin_top_15 margin_left_20 radio_normal">
								</div>
								<span  style="margin-left: 5px;" class="float_left">主险</span>
								<div id="category_add"  class="float_left margin_top_15 margin_left_20 radio_normal">
								</div>
								<span  style="margin-left: 5px;" class="float_left">附加险</span>
								<div id="category_other"  class="float_left margin_top_15 margin_left_20 radio_normal">
								</div>
								<span  style="margin-left: 5px;" class="float_left">其他</span>
							</div>
						</div>
						<div class="hangstyle">
							<div class="float_left titlename">注册号：</div>
							<div class="input_div" style="width: 300px;">
								<input type="tel" name="productNO" value="${productInfo.productNO}"/>
							</div>
						</div>
						<div class="hangstyle">
							<div class="float_left titlename">注册人：</div>
							<div class="input_div"  style="width: 300px;">
								<input type="tel" name="registPerson" value="${productInfo.registPerson}"/>
							</div>
						</div>
						<div class="hangstyle">
							<div class="float_left titlename">产品名称：</div>
							<div class="input_div" style="width: 300px;">
								<input type="tel"  value="${productInfo.productName}" name="productName"/>
							</div>
						</div>
					</div>
				<div class="float_left leftbox">
						<div class="hangstyle margin_top_10">
						<input type="hidden" id="status" name="status" value="${productInfo.status}" />
							<div class="float_left titlename" >状态：</div>
							<div class="input_div" >
								<div id="status_all" class="float_left margin_top_15 margin_left_10 radio_normal">
								</div>
								<span  style="margin-left: 5px;" class="float_left">全部</span>
								<div id="status_normal" class="float_left margin_top_15 margin_left_10 radio_normal">
								</div>
								<span  style="margin-left: 5px;" class="float_left">正常</span>
								<div id="status_cancle" name="status" value="1" class="float_left margin_top_15 margin_left_20 radio_normal">
								</div>
								<span  style="margin-left: 5px;" name="status" value="2" class="float_left">注销</span>
							</div>
						</div>
						<div class="hangstyle">
							<div class="float_left titlename">险类：</div>
							<div class="input_div"  style="width: 300px;">
								<@dictSelect value="${productInfo.riskType}" type="RISK" id="riskType" name="riskType" option="全部" showSelect=true onChange="getRiskName(this.options[this.selectedIndex].value);"/>
							</div>
						</div>
						<div class="hangstyle">
							<div class="float_left titlename">险种：</div>
							<div  class="input_div" style="width: 300px;">
								<@dictSelect value="${productInfo.riskName}" type="${productInfo.riskType}" id="riskName" name="riskName" option="全部" showSelect=true/>
							</div>
						</div>
					</div>
				</div>
				<input id="hquerypage" name="page" type="hidden" >
				<div class="bottomdiv">
					<button onclick="select();">查&nbsp;&nbsp;&nbsp;&nbsp;询</button>
				</div>
			</div>
		</form>
		<div class="product_content" align="center">
			<div class="toptitle">
				<div class="contentname">
				<div>序号</div>
				<div>注册号</div>
				<div>产品名称</div>
				<div>注册人</div>
				<div>类别</div>
				<div>险类</div>
				<div>险种</div>
				<div>注册时间</div>
				<div>状态</div>
				<div>查询详情</div>
			</div>
			</div>
			<div class="content_all">
				<ul class="contentall_li">
				<#if products??> 
					<#list products as product>
						<li>
						<div class="lidiv">
							<div>
								&nbsp;&nbsp;${product_index +productInfo.currentRowNo?default(1)}
							</div>
							<div>
							    ${product.productNO}
							</div>
							<div title="${product.productName}">
								<@textCut value="${product.productName}" len=12 append="..." />
							</div>
							<div title="${product.registPerson}">
								<@textCut value="${product.registPerson}" len=12 append="..." />
							</div>
							<div>
								&nbsp;&nbsp;<#if (product.productType ="1")>主险</#if>
											<#if (product.productType ="2")>附加险</#if>
											<#if (product.productType ="3")>其他</#if>
							</div>
							<div >
								&nbsp;&nbsp;<@dictDisplay value="${product.riskType}" type="RISK" />
							</div>
							<div>
								&nbsp;&nbsp;<@dictDisplay value="${product.riskName}" type="${product.riskType}" />
							</div>
							<div >
								&nbsp;&nbsp;${product.registTime?string("yyyy-MM-dd HH:mm:ss")}
							</div>
							<div >
								&nbsp;&nbsp;<#if (product.status ="1")>正常</#if><#if (product.status ="4")>注销</#if><#if (product.status ="3")>待核查</#if>
							</div>
							<div >
								<#if (product.protectionType ="1")>
									<button type="button" onclick="tishi('${product.registPerson}');">在保护期</button>
						       	</#if>
                                <#if (product.riskName!="89OB")>
                                    <#if (product.protectionType ="2")>
                                        <button type="button" onclick="detail('${product.productNO}');">查看详情</button>
                                    </#if>
                                </#if>
								
							</div>
						</div>
						</li>
					</#list>
   		 		</#if> 
				</ul>
			</div>
			<div class="divbottom">
				<div class="pager-plugin" id="pager"></div>
				
				</div>
		</div>
	
	
<div class="fisrt_bottom_xian"></div>
<!--<#include "foot.html"/><!--尾部结束-->
		<script type="text/javascript">
		
			$(function(){
				//单选按钮初始化
				var productType = $("#productType").val();
				var status = $("#status").val();     
				if(productType == "" || productType == 0){
					$("#category_all").removeClass("radio_normal").addClass("radio_checked");
				}
				if(productType == 1){
					$("#category_pre").removeClass("radio_normal").addClass("radio_checked");
				}
				if(productType == 2){
					$("#category_add").removeClass("radio_normal").addClass("radio_checked");
				}
				//其他类别
                if(productType == 3){
                    $("#category_other").removeClass("radio_normal").addClass("radio_checked");
                }
				if(status == "" || status == 0){
					$("#status_all").removeClass("radio_normal").addClass("radio_checked");
				}
				if(status == 1){
					$("#status_normal").removeClass("radio_normal").addClass("radio_checked");
				}
				if(status == 4){
					$("#status_cancle").removeClass("radio_normal").addClass("radio_checked");
				}
				//单选按钮事件
				$("#category_all").click(function(){
					if($("#category_pre").hasClass("radio_checked")||$("#category_add").hasClass("radio_checked")||$("#category_other").hasClass("radio_checked")){
						$("#category_add").removeClass("radio_checked").addClass("radio_normal");
						$("#category_pre").removeClass("radio_checked").addClass("radio_normal");
						$("#category_all").removeClass("radio_normal").addClass("radio_checked");
                        $("#category_other").removeClass("radio_checked").addClass("radio_normal");
						$("#productType").val(0);
					}
				});
				$("#category_pre").click(function(){
					if($("#category_add").hasClass("radio_checked")||$("#category_all").hasClass("radio_checked")||$("#category_other").hasClass("radio_checked")){
						$("#category_add").removeClass("radio_checked").addClass("radio_normal");
						$("#category_all").removeClass("radio_checked").addClass("radio_normal");
						$("#category_pre").removeClass("radio_normal").addClass("radio_checked");
                        $("#category_other").removeClass("radio_checked").addClass("radio_normal");
						$("#productType").val(1);
					}
				});
				$("#category_add").click(function(){
                    if($("#category_pre").hasClass("radio_checked")||$("#category_all").hasClass("radio_checked")||$("#category_other").hasClass("radio_checked")){
                        $("#category_pre").removeClass("radio_checked").addClass("radio_normal");
                        $("#category_all").removeClass("radio_checked").addClass("radio_normal");
                        $("#category_add").removeClass("radio_normal").addClass("radio_checked");
                        $("#category_other").removeClass("radio_checked").addClass("radio_normal");
                        $("#productType").val(2);
                    }
                });
                $("#category_other").click(function(){
                    if($("#category_pre").hasClass("radio_checked")||$("#category_all").hasClass("radio_checked")||$("#category_add").hasClass("radio_checked")){
                        $("#category_pre").removeClass("radio_checked").addClass("radio_normal");
                        $("#category_all").removeClass("radio_checked").addClass("radio_normal");
                        $("#category_add").removeClass("radio_checked").addClass("radio_normal");
                        $("#category_other").removeClass("radio_normal").addClass("radio_checked");
                        $("#productType").val(3);
                    }
                });
				$("#status_all").click(function(){
					if($("#status_cancle").hasClass("radio_checked")||$("#status_normal").hasClass("radio_checked")){
						$("#status_cancle").removeClass("radio_checked").addClass("radio_normal");
						$("#status_normal").removeClass("radio_checked").addClass("radio_normal");
						$("#status_all").removeClass("radio_normal").addClass("radio_checked");
						$("#status").val(0);
					}
				});
				$("#status_normal").click(function(){
					if($("#status_cancle").hasClass("radio_checked")||$("#status_all").hasClass("radio_checked")){
						$("#status_cancle").removeClass("radio_checked").addClass("radio_normal");
						$("#status_all").removeClass("radio_checked").addClass("radio_normal");
						$("#status_normal").removeClass("radio_normal").addClass("radio_checked");
						$("#status").val(1);
					}
				});
				$("#status_cancle").click(function(){
					if($("#status_normal").hasClass("radio_checked")||$("#status_all").hasClass("radio_checked")){
						$("#status_normal").removeClass("radio_checked").addClass("radio_normal");
						$("#status_all").removeClass("radio_checked").addClass("radio_normal");
						$("#status_cancle").removeClass("radio_normal").addClass("radio_checked");
						$("#status").val(4);
					}
				});
				
				
				//给列表设置样式,行数为单数样式为#----.contentall_li
				$(".contentall_li li:even").css("background-color","#E6E3E3");
				$(".contentall_li li:odd").css("background-color","#F2F2F2");
				$(".selectstyle ul li:not(.optionselect)").hover(
					function(){
						$(this).css("background-color","#69AAEC");
						$(this).css("color","#fff");
					},
					function(){
						$(this).css("background-color","#fff");
						$(this).css("color","#333");
					}
				);
				
			    
			});
			
			//分页
			PageClick = function(pageclickednumber) {
		        $("#pager").pager({ pagenumber: pageclickednumber, pagecount: total, buttonClickCallback: PageClick });
		        //跳转
		       // location = '?page='+pageclickednumber;
		        $("#hquerypage").val(pageclickednumber);
		        $("#submit_product_info").submit();
		    }
			var total = ${total};
		    if(total > 0)
			{
			   total = Math.floor(total%10==0?total/10:(total/10+1));
			   $("#pager").pager({ pagenumber: ${productInfo.page?default(1)}, pagecount: total, buttonClickCallback: PageClick });
			}
		    

			//筛选条件
			function select(){
				$("#submit_product_info").submit();
			}
			//查看详情
			function detail(productNO){
				 window.location.href="<@s.url '/front/product/detail?productNO='/>"+productNO;
			}
			//tishi
			function tishi(registPerson){
				alert("如想投保，请联系"+registPerson+"！");
			}

			//险种二级联动
			  function getRiskName(key){
				$("#riskName").html("");
				$("#riskName").append("<option value=''>全部</option>");
				  $.ajax({
				        type : "post",
				        url : "<@s.url '/front/product/riskName'/>",
				        data : {
				        	key : $("#riskType").val()
				        },
				        dataType : "json",
				        success : function(data) {
				        	if(data.success)
							{
					           for(var i =0;i<data.data.length;i++){
					        	   var dic=data.data[i].split("|");
					        	   $("#riskName").append("<option value='" + dic[0] + "'>"  + dic[1] + "</option>"); 
					          } 
							}
				        }
				   });  
			  }
		    
		</script>
	</body>
</html>
